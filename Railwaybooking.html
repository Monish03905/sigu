<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Railway Booking</title>
  <style>
    :root {
      --bg: #0f172a;         /* slate-900 */
      --card: #111827;       /* gray-900 */
      --muted: #94a3b8;      /* slate-400 */
      --text: #e5e7eb;       /* gray-200 */
      --accent: #22d3ee;     /* cyan-400 */
      --accent-2: #60a5fa;   /* blue-400 */
      --ok: #34d399;         /* green-400 */
      --warn: #f59e0b;       /* amber-500 */
      --danger: #f87171;     /* red-400 */
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
      background: radial-gradient(1200px 700px at 20% -10%, #1e293b 0%, var(--bg) 45%),
                  radial-gradient(900px 600px at 120% 10%, #1f2a44 0%, var(--bg) 55%),
                  var(--bg);
      color: var(--text);
    }

    .container { max-width: 1100px; margin: 32px auto; padding: 0 16px; }

    .app-title { font-size: 28px; font-weight: 800; letter-spacing: 0.3px; display:flex; align-items:center; gap:12px; }
    .pill { font-size: 12px; color: #0b1220; background: linear-gradient(135deg, var(--accent), var(--accent-2)); padding:4px 10px; border-radius: 999px; font-weight: 700; }

    .grid { display:grid; gap: 16px; }
    .grid-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    .grid-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
    @media (max-width: 860px){ .grid-2, .grid-3 { grid-template-columns: 1fr; } }

    .card {
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border: 1px solid rgba(148,163,184,.15);
      border-radius: var(--radius); padding: 18px; box-shadow: var(--shadow);
      backdrop-filter: blur(6px);
    }

    label { font-size: 12px; color: var(--muted); display:block; margin-bottom:6px; }
    input, select { width: 100%; padding: 12px 12px; border-radius: 12px; border: 1px solid rgba(148,163,184,.2); background: #0b1220; color: var(--text); outline: none; }
    input:focus, select:focus { border-color: var(--accent); box-shadow: 0 0 0 4px rgba(34,211,238, .15); }

    .btn {
      appearance:none; border:0; cursor:pointer; font-weight:700; padding:12px 16px; border-radius: 12px; color:#0b1220; background: linear-gradient(135deg, var(--accent), var(--accent-2));
      transition: transform .06s ease; box-shadow: 0 10px 20px rgba(96,165,250,.25);
    }
    .btn:active { transform: translateY(1px) scale(.997); }
    .btn.secondary { background:#111827; color: var(--text); border:1px solid rgba(148,163,184,.2); box-shadow:none; }

    table { width: 100%; border-collapse: collapse; }
    th, td { text-align: left; padding: 12px; border-bottom: 1px solid rgba(148,163,184,.15); }
    th { font-size: 12px; color: var(--muted); font-weight: 700; }

    .badge { font-size: 11px; padding: 4px 8px; border-radius: 999px; border:1px solid rgba(148,163,184,.25); color: var(--text); background: #0b1220; }

    .flex { display:flex; gap:12px; align-items:center; }
    .justify-between { justify-content: space-between; }

    .summary { font-size: 14px; color: var(--muted); }
    .price { font-size: 22px; font-weight: 800; background: linear-gradient(120deg, var(--accent), var(--ok)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

    .toast { position: fixed; right: 16px; bottom: 16px; background: #0b1220; color: var(--text); border:1px solid rgba(148,163,184,.2); padding: 12px 16px; border-radius: 12px; box-shadow: var(--shadow); opacity:0; transform: translateY(8px); transition: .25s ease; }
    .toast.show { opacity: 1; transform: translateY(0); }
  </style>
</head>
<body>
  <div class="container">
    <div class="flex justify-between" style="margin-bottom:16px">
      <div class="app-title">ðŸš† Railway Booking <span class="pill">Demo</span></div>
      <button class="btn secondary" id="resetAll">Reset</button>
    </div>

    <!-- Search Card -->
    <section class="card" aria-label="Search trains">
      <form id="searchForm">
        <div class="grid grid-3">
          <div>
            <label for="from">From</label>
            <input id="from" name="from" placeholder="e.g., HYB â€” Hyderabad" required />
          </div>
          <div>
            <label for="to">To</label>
            <input id="to" name="to" placeholder="e.g., SC â€” Secunderabad" required />
          </div>
          <div>
            <label for="date">Journey Date</label>
            <input type="date" id="date" name="date" required />
          </div>
        </div>
        <div class="grid grid-3" style="margin-top:12px">
          <div>
            <label for="coach">Class</label>
            <select id="coach" name="coach">
              <option value="2S">2S â€” Second Sitting</option>
              <option value="SL" selected>SL â€” Sleeper</option>
              <option value="3A">3A â€” AC 3 Tier</option>
              <option value="2A">2A â€” AC 2 Tier</option>
              <option value="1A">1A â€” AC First</option>
            </select>
          </div>
          <div>
            <label for="quota">Quota</label>
            <select id="quota" name="quota">
              <option value="GN" selected>General</option>
              <option value="TQ">Tatkal</option>
              <option value="LD">Ladies</option>
              <option value="PT">Premium Tatkal</option>
            </select>
          </div>
          <div>
            <label for="pax">Passengers</label>
            <input type="number" id="pax" name="pax" min="1" max="6" value="1" required />
          </div>
        </div>
        <div class="flex" style="margin-top:14px">
          <button class="btn" type="submit">Search Trains</button>
          <span class="summary" id="searchHint">Enter route and date to see options.</span>
        </div>
      </form>
    </section>

    <!-- Results Card -->
    <section class="card" aria-label="Available trains" style="margin-top:16px">
      <div class="flex justify-between" style="margin-bottom:8px">
        <div class="summary">Results</div>
        <div class="summary"><span class="badge" id="resultCount">0 trains</span></div>
      </div>
      <div style="overflow:auto">
        <table id="resultsTable" aria-describedby="Available trains">
          <thead>
            <tr>
              <th>Train</th>
              <th>Number</th>
              <th>Dep â†’ Arr</th>
              <th>Duration</th>
              <th>Class</th>
              <th>Fare</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr><td colspan="7" class="summary">No results yet. Search above.</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Passenger Details -->
    <section class="card" aria-label="Passenger details" style="margin-top:16px">
      <div class="grid grid-2">
        <div>
          <div class="summary" style="margin-bottom:8px">Passenger Details</div>
          <div id="passengerFields">
            <div class="grid" style="grid-template-columns: 2fr 1fr 1fr; gap: 12px;">
              <div>
                <label>Full Name</label>
                <input placeholder="e.g., Monish Ratan" id="paxName0" />
              </div>
              <div>
                <label>Age</label>
                <input type="number" min="1" max="120" placeholder="20" id="paxAge0" />
              </div>
              <div>
                <label>Gender</label>
                <select id="paxGen0">
                  <option value="M">Male</option>
                  <option value="F">Female</option>
                  <option value="O" selected>Other</option>
                </select>
              </div>
            </div>
          </div>
          <div class="flex" style="margin-top:12px">
            <button class="btn secondary" id="addPassenger" type="button">+ Add Passenger</button>
            <span class="summary">Max 6 passengers per booking.</span>
          </div>
        </div>
        <div>
          <div class="summary" style="margin-bottom:8px">Booking Summary</div>
          <div class="grid">
            <div class="flex justify-between"><span>Selected Train</span><span id="selTrain" class="badge">â€”</span></div>
            <div class="flex justify-between"><span>Coach</span><span id="selCoach" class="badge">â€”</span></div>
            <div class="flex justify-between"><span>Base Fare</span><span id="selFare" class="badge">â‚¹0</span></div>
            <div class="flex justify-between"><span>Passengers</span><span id="selPax" class="badge">0</span></div>
            <div class="flex justify-between"><span>Total</span><span class="price" id="totalPrice">â‚¹0</span></div>
            <button class="btn" id="confirmBtn" type="button" disabled>Confirm Booking</button>
          </div>
        </div>
      </div>
    </section>
  </div>

  <div class="toast" id="toast">Booking created (demo). Check console for payload.</div>

  <script>
    // --- Utilities ---
    const fmtINR = (n) => new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR', maximumFractionDigits: 0}).format(n);
    const el = (id) => document.getElementById(id);

    // --- Mock search (static data for demo) ---
    const MOCK_TRAINS = [
      { name: 'Gowthami SF Express', no: '12737', dep: '21:00', arr: '06:30', dur: '9h 30m', base: { '2S': 145, 'SL': 325, '3A': 1245, '2A': 1840, '1A': 2980 } },
      { name: 'Charminar Express',   no: '12759', dep: '18:30', arr: '04:20', dur: '9h 50m', base: { '2S': 165, 'SL': 350, '3A': 1290, '2A': 1890, '1A': 3040 } },
      { name: 'Rajdhani Express',    no: '12437', dep: '16:45', arr: '03:05', dur: '10h 20m', base: { '2S': 0,   'SL': 0,   '3A': 2340, '2A': 3420, '1A': 5070 } },
      { name: 'Vande Bharat',        no: '20834', dep: '06:00', arr: '13:10', dur: '7h 10m',  base: { '2S': 0,   'SL': 0,   '3A': 1820, '2A': 0,    '1A': 0 } },
    ];

    const quotaMultiplier = (q) => ({ GN: 1, TQ: 1.3, PT: 1.45, LD: 0.95 })[q] || 1;

    function renderResults(trains, coach, quota, paxCount){
      const tbody = document.querySelector('#resultsTable tbody');
      tbody.innerHTML = '';
      let count = 0;
      trains.forEach(t => {
        const base = t.base[coach] || 0;
        if(!base) return; // skip unavailable class
        count++;
        const fare = Math.round(base * quotaMultiplier(quota));
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${t.name}</td>
          <td><span class="badge">${t.no}</span></td>
          <td>${t.dep} â†’ ${t.arr}</td>
          <td>${t.dur}</td>
          <td><span class="badge">${coach}</span></td>
          <td>${fmtINR(fare)}</td>
          <td><button class="btn" data-train='${JSON.stringify({no:t.no,name:t.name,base:fare})}'>Select</button></td>
        `;
        tbody.appendChild(tr);
      });
      if(count === 0){
        tbody.innerHTML = '<tr><td colspan="7" class="summary">No trains available for selected class/quota.</td></tr>';
      }
      el('resultCount').textContent = `${count} train${count!==1?'s':''}`;
    }

    function setMinDate(){
      const today = new Date();
      const yyyy = today.getFullYear();
      const mm = String(today.getMonth()+1).padStart(2,'0');
      const dd = String(today.getDate()).padStart(2,'0');
      const min = `${yyyy}-${mm}-${dd}`;
      el('date').min = min;
      el('date').value = min;
    }

    function updatePaxFields(count){
      const wrap = el('passengerFields');
      wrap.innerHTML = '';
      for(let i=0;i<count;i++){
        const row = document.createElement('div');
        row.className = 'grid';
        row.style.gridTemplateColumns = '2fr 1fr 1fr';
        row.style.gap = '12px';
        row.style.marginBottom = '10px';
        row.innerHTML = `
          <div>
            <label>Full Name</label>
            <input placeholder="Passenger ${i+1}" id="paxName${i}" required />
          </div>
          <div>
            <label>Age</label>
            <input type="number" min="1" max="120" placeholder="25" id="paxAge${i}" required />
          </div>
          <div>
            <label>Gender</label>
            <select id="paxGen${i}">
              <option value="M">Male</option>
              <option value="F">Female</option>
              <option value="O" selected>Other</option>
            </select>
          </div>`;
        wrap.appendChild(row);
      }
    }

    function showToast(msg){
      const t = el('toast');
      t.textContent = msg;
      t.classList.add('show');
      setTimeout(()=> t.classList.remove('show'), 2600);
    }

    // --- State ---
    let selected = null; // {no, name, base}

    // --- Event wiring ---
    setMinDate();
    updatePaxFields(Number(el('pax').value));

    el('searchForm').addEventListener('submit', (e)=>{
      e.preventDefault();
      const coach = el('coach').value;
      const quota = el('quota').value;
      const paxCount = Math.min(6, Math.max(1, Number(el('pax').value||1)));
      renderResults(MOCK_TRAINS, coach, quota, paxCount);
      selected = null;
      el('selTrain').textContent = 'â€”';
      el('selCoach').textContent = coach;
      el('selFare').textContent = fmtINR(0);
      el('selPax').textContent = String(paxCount);
      el('totalPrice').textContent = fmtINR(0);
      el('confirmBtn').disabled = true;
      el('searchHint').textContent = 'Select a train to continue.';
    });

    document.querySelector('#resultsTable').addEventListener('click', (e)=>{
      const btn = e.target.closest('button');
      if(!btn) return;
      try {
        const data = JSON.parse(btn.getAttribute('data-train'));
        selected = data; // base already multiplied by quota
        const paxCount = Math.min(6, Math.max(1, Number(el('pax').value||1)));
        const total = selected.base * paxCount;
        el('selTrain').textContent = `${selected.name} (${selected.no})`;
        el('selFare').textContent = fmtINR(selected.base);
        el('selPax').textContent = String(paxCount);
        el('selCoach').textContent = el('coach').value;
        el('totalPrice').textContent = fmtINR(total);
        el('confirmBtn').disabled = false;
        showToast('Train selected');
      } catch(err){ console.error(err); }
    });

    el('addPassenger').addEventListener('click', ()=>{
      const current = document.querySelectorAll('#passengerFields input[id^="paxName"]').length;
      const target = Math.min(6, current + 1);
      el('pax').value = target;
      updatePaxFields(target);
    });

    el('pax').addEventListener('change', ()=>{
      const n = Math.min(6, Math.max(1, Number(el('pax').value||1)));
      el('pax').value = n;
      updatePaxFields(n);
    });

    el('confirmBtn').addEventListener('click', ()=>{
      if(!selected){ showToast('Please select a train first.'); return; }
      // Minimal validation
      const paxCount = Math.min(6, Math.max(1, Number(el('pax').value||1)));
      const pax = [];
      for(let i=0;i<paxCount;i++){
        const name = el(`paxName${i}`).value.trim();
        const age = Number(el(`paxAge${i}`).value);
        const gen = el(`paxGen${i}`).value;
        if(!name || !age){ showToast('Enter passenger details.'); return; }
        pax.push({ name, age, gender: gen });
      }

      const payload = {
        from: el('from').value.trim(),
        to: el('to').value.trim(),
        date: el('date').value,
        coach: el('coach').value,
        quota: el('quota').value,
        passengers: pax,
        train: selected,
        total: selected.base * pax.length,
        createdAt: new Date().toISOString()
      };

      console.log('Booking payload (demo):', payload);
      showToast('Booking created (demo). Open console to view.');
    });

    el('resetAll').addEventListener('click', ()=>{
      document.querySelector('form#searchForm').reset();
      setMinDate();
      updatePaxFields(1);
      document.querySelector('#resultsTable tbody').innerHTML = '<tr><td colspan="7" class="summary">No results yet. Search above.</td></tr>';
      el('resultCount').textContent = '0 trains';
      selected = null;
      el('selTrain').textContent = 'â€”';
      el('selCoach').textContent = 'â€”';
      el('selFare').textContent = fmtINR(0);
      el('selPax').textContent = '0';
      el('totalPrice').textContent = fmtINR(0);
      el('confirmBtn').disabled = true;
      el('searchHint').textContent = 'Enter route and date to see options.';
    });
  </script>
</body>
</html>
